#!/bin/bash

echo "üîß –û—á–∏—Å—Ç–∫–∞ Redis –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π rate limiting..."

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Redis –∏ —É–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª—é—á–∏ rate limiting
redis-cli --scan --pattern "rate_limit:*" | xargs -r redis-cli del

echo "‚úÖ Redis –æ—á–∏—â–µ–Ω –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π"
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2 –∫–ª–∞—Å—Ç–µ—Ä–∞..."

# –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–µ–∑ downtime
pm2 reload pm2.config.js

echo "‚úÖ PM2 –∫–ª–∞—Å—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω"
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:"
pm2 list 